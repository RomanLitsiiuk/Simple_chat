"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var System=function(e){function i(e,t,r){var n;return _classCallCheck(this,i),(n=_possibleConstructorReturn(this,_getPrototypeOf(i).call(this))).addButton=e,n.wrap=t,n.nameField=r,n.iframes=[],n.invalidName=!1,n}return _inherits(i,Mediator),_createClass(i,[{key:"checkFramesCount",value:function(){return this.iframes.length+1}},{key:"addFrame",value:function(e,t){var r=this,n=new IFrame(t||"iFrame".concat(this.checkFramesCount()),this).renderIframe();this.iframes.push(n),e.append(n),setTimeout(function(){r.publish("receivedMessage",{message:"[system]: ".concat(n.name," joined the conversation"),type:"system"})},300)}},{key:"removeFrame",value:function(t){var e=this.iframes.find(function(e){if(e)return e.name===t});this.iframes.splice(this.iframes.indexOf(e),0,null),this.wrap.removeChild(e),this.publish("receivedMessage",{message:"[system]: ".concat(t," left this conversation"),type:"system"})}},{key:"validate",value:function(t){return this.invalidName=this.iframes.some(function(e){return e.name===t}),this.invalidName}},{key:"render",value:function(){var t=this,e=document.querySelector(".error");this.nameField.addEventListener("input",function(){i.showValidationField(e,t.validate(t.nameField.value.trim()))}),this.addButton.addEventListener("click",function(){i.showValidationField(e,t.validate(t.nameField.value.trim())),t.validate(t.nameField.value.trim())||t.addFrame(t.wrap,t.nameField.value.trim())}),window.addEventListener("message",function(e){e.data&&"object"!==_typeof(e.data)?t.publish("receivedMessage",{message:e.data,type:"user"}):e.data.hasOwnProperty("remove")&&t.removeFrame(e.data.remove)})}}],[{key:"showValidationField",value:function(e,t){t?e.classList.add("error--active"):e.classList.remove("error--active")}}]),i}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3N5c3RlbS5qcyJdLCJuYW1lcyI6WyJTeXN0ZW0iLCJidXR0b24iLCJ3cmFwcGVyIiwibmFtZUZpZWxkIiwiX3RoaXMiLCJfY2xhc3NDYWxsQ2hlY2siLCJ0aGlzIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iLCJfZ2V0UHJvdG90eXBlT2YiLCJjYWxsIiwiYWRkQnV0dG9uIiwid3JhcCIsImlmcmFtZXMiLCJpbnZhbGlkTmFtZSIsIk1lZGlhdG9yIiwibGVuZ3RoIiwibmFtZSIsIl90aGlzMiIsImZyYW1lIiwiSUZyYW1lIiwiY29uY2F0IiwiY2hlY2tGcmFtZXNDb3VudCIsInJlbmRlcklmcmFtZSIsInB1c2giLCJhcHBlbmQiLCJzZXRUaW1lb3V0IiwicHVibGlzaCIsIm1lc3NhZ2UiLCJ0eXBlIiwiZGVsZXRlZCIsImZpbmQiLCJzcGxpY2UiLCJpbmRleE9mIiwicmVtb3ZlQ2hpbGQiLCJzb21lIiwiX3RoaXMzIiwiZXJyb3IiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwic2hvd1ZhbGlkYXRpb25GaWVsZCIsInZhbGlkYXRlIiwidmFsdWUiLCJ0cmltIiwiYWRkRnJhbWUiLCJ3aW5kb3ciLCJkYXRhIiwiX3R5cGVvZiIsImhhc093blByb3BlcnR5IiwicmVtb3ZlRnJhbWUiLCJyZW1vdmUiLCJlcnJvckZpZWxkIiwidmFsaWRTdGF0dXMiLCJjbGFzc0xpc3QiLCJhZGQiXSwibWFwcGluZ3MiOiJBQUFBLGs2Q0FFTUEsbUJBQ0osU0FBQUEsRUFBWUMsRUFBUUMsRUFBU0MsR0FBVyxJQUFBQyxFQUFBLE9BQUFDLGdCQUFBQyxLQUFBTixJQUN0Q0ksRUFBQUcsMkJBQUFELEtBQUFFLGdCQUFBUixHQUFBUyxLQUFBSCxRQUNLSSxVQUFZVCxFQUNqQkcsRUFBS08sS0FBT1QsRUFDWkUsRUFBS0QsVUFBWUEsRUFDakJDLEVBQUtRLFFBQVUsR0FDZlIsRUFBS1MsYUFBYyxFQU5tQlQscUJBRHJCVSxtRUFXakIsT0FBT1IsS0FBS00sUUFBUUcsT0FBUyxtQ0FHdEJiLEVBQVNjLEdBQU0sSUFBQUMsRUFBQVgsS0FDaEJZLEVBQVEsSUFBSUMsT0FBT0gsR0FBSSxTQUFBSSxPQUFhZCxLQUFLZSxvQkFBc0JmLE1BQU1nQixlQUMzRWhCLEtBQUtNLFFBQVFXLEtBQUtMLEdBQ2xCaEIsRUFBUXNCLE9BQU9OLEdBQ2ZPLFdBQVcsV0FDVFIsRUFBS1MsUUFBUSxrQkFBbUIsQ0FDOUJDLFFBQU8sYUFBQVAsT0FBZUYsRUFBTUYsS0FBckIsNEJBQ1BZLEtBQU0sWUFFUCx5Q0FHT1osR0FDVixJQUFNYSxFQUFVdkIsS0FBS00sUUFBUWtCLEtBQUssU0FBQ1osR0FDakMsR0FBSUEsRUFDRixPQUFPQSxFQUFNRixPQUFTQSxJQUcxQlYsS0FBS00sUUFBUW1CLE9BQU96QixLQUFLTSxRQUFRb0IsUUFBUUgsR0FBVSxFQUFHLE1BQ3REdkIsS0FBS0ssS0FBS3NCLFlBQVlKLEdBQ3RCdkIsS0FBS29CLFFBQVEsa0JBQW1CLENBQzlCQyxRQUFPLGFBQUFQLE9BQWVKLEVBQWYsMkJBQ1BZLEtBQU0sNENBUURaLEdBSVAsT0FIQVYsS0FBS08sWUFBY1AsS0FBS00sUUFBUXNCLEtBQUssU0FBQ2hCLEdBQ3BDLE9BQU9BLEVBQU1GLE9BQVNBLElBRWpCVixLQUFLTyw2Q0FHTCxJQUFBc0IsRUFBQTdCLEtBQ0Q4QixFQUFRQyxTQUFTQyxjQUFjLFVBQ3JDaEMsS0FBS0gsVUFBVW9DLGlCQUFpQixRQUFTLFdBQ3ZDdkMsRUFBT3dDLG9CQUFvQkosRUFBT0QsRUFBS00sU0FBU04sRUFBS2hDLFVBQVV1QyxNQUFNQyxXQUV2RXJDLEtBQUtJLFVBQVU2QixpQkFBaUIsUUFBUyxXQUN2Q3ZDLEVBQU93QyxvQkFBb0JKLEVBQU9ELEVBQUtNLFNBQVNOLEVBQUtoQyxVQUFVdUMsTUFBTUMsU0FDaEVSLEVBQUtNLFNBQVNOLEVBQUtoQyxVQUFVdUMsTUFBTUMsU0FDdENSLEVBQUtTLFNBQVNULEVBQUt4QixLQUFNd0IsRUFBS2hDLFVBQVV1QyxNQUFNQyxVQUdsREUsT0FBT04saUJBQWlCLFVBQVcsU0FBQ1osR0FDOUJBLEVBQVFtQixNQUFnQyxXQUF4QkMsUUFBT3BCLEVBQVFtQixNQUNqQ1gsRUFBS1QsUUFBUSxrQkFBbUIsQ0FDOUJDLFFBQVNBLEVBQVFtQixLQUNqQmxCLEtBQU0sU0FFQ0QsRUFBUW1CLEtBQUtFLGVBQWUsV0FDckNiLEVBQUtjLFlBQVl0QixFQUFRbUIsS0FBS0ksd0RBN0JUQyxFQUFZQyxHQUNyQ0EsRUFBY0QsRUFBV0UsVUFBVUMsSUFBSSxpQkFBbUJILEVBQVdFLFVBQVVILE9BQU8iLCJmaWxlIjoianMvc3lzdGVtLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcclxuXHJcbmNsYXNzIFN5c3RlbSBleHRlbmRzIE1lZGlhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihidXR0b24sIHdyYXBwZXIsIG5hbWVGaWVsZCkge1xyXG4gICAgc3VwZXIoKTtcclxuICAgIHRoaXMuYWRkQnV0dG9uID0gYnV0dG9uO1xyXG4gICAgdGhpcy53cmFwID0gd3JhcHBlcjtcclxuICAgIHRoaXMubmFtZUZpZWxkID0gbmFtZUZpZWxkO1xyXG4gICAgdGhpcy5pZnJhbWVzID0gW107XHJcbiAgICB0aGlzLmludmFsaWROYW1lID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBjaGVja0ZyYW1lc0NvdW50KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuaWZyYW1lcy5sZW5ndGggKyAxO1xyXG4gIH1cclxuXHJcbiAgYWRkRnJhbWUod3JhcHBlciwgbmFtZSkge1xyXG4gICAgY29uc3QgZnJhbWUgPSBuZXcgSUZyYW1lKG5hbWUgfHwgYGlGcmFtZSR7dGhpcy5jaGVja0ZyYW1lc0NvdW50KCl9YCwgdGhpcykucmVuZGVySWZyYW1lKCk7XHJcbiAgICB0aGlzLmlmcmFtZXMucHVzaChmcmFtZSk7XHJcbiAgICB3cmFwcGVyLmFwcGVuZChmcmFtZSk7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgdGhpcy5wdWJsaXNoKCdyZWNlaXZlZE1lc3NhZ2UnLCB7XHJcbiAgICAgICAgbWVzc2FnZTogYFtzeXN0ZW1dOiAke2ZyYW1lLm5hbWV9IGpvaW5lZCB0aGUgY29udmVyc2F0aW9uYCxcclxuICAgICAgICB0eXBlOiAnc3lzdGVtJ1xyXG4gICAgICB9KTtcclxuICAgIH0sIDMwMCk7XHJcbiAgfVxyXG5cclxuICByZW1vdmVGcmFtZShuYW1lKSB7XHJcbiAgICBjb25zdCBkZWxldGVkID0gdGhpcy5pZnJhbWVzLmZpbmQoKGZyYW1lKSA9PiB7XHJcbiAgICAgIGlmIChmcmFtZSkge1xyXG4gICAgICAgIHJldHVybiBmcmFtZS5uYW1lID09PSBuYW1lO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHRoaXMuaWZyYW1lcy5zcGxpY2UodGhpcy5pZnJhbWVzLmluZGV4T2YoZGVsZXRlZCksIDAsIG51bGwpO1xyXG4gICAgdGhpcy53cmFwLnJlbW92ZUNoaWxkKGRlbGV0ZWQpO1xyXG4gICAgdGhpcy5wdWJsaXNoKCdyZWNlaXZlZE1lc3NhZ2UnLCB7XHJcbiAgICAgIG1lc3NhZ2U6IGBbc3lzdGVtXTogJHtuYW1lfSBsZWZ0IHRoaXMgY29udmVyc2F0aW9uYCxcclxuICAgICAgdHlwZTogJ3N5c3RlbSdcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIHNob3dWYWxpZGF0aW9uRmllbGQoZXJyb3JGaWVsZCwgdmFsaWRTdGF0dXMpIHtcclxuICAgIHZhbGlkU3RhdHVzID8gZXJyb3JGaWVsZC5jbGFzc0xpc3QuYWRkKCdlcnJvci0tYWN0aXZlJykgOiBlcnJvckZpZWxkLmNsYXNzTGlzdC5yZW1vdmUoJ2Vycm9yLS1hY3RpdmUnKTtcclxuICB9XHJcblxyXG4gIHZhbGlkYXRlKG5hbWUpIHtcclxuICAgIHRoaXMuaW52YWxpZE5hbWUgPSB0aGlzLmlmcmFtZXMuc29tZSgoZnJhbWUpID0+IHtcclxuICAgICAgcmV0dXJuIGZyYW1lLm5hbWUgPT09IG5hbWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0aGlzLmludmFsaWROYW1lO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3QgZXJyb3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZXJyb3InKTtcclxuICAgIHRoaXMubmFtZUZpZWxkLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xyXG4gICAgICBTeXN0ZW0uc2hvd1ZhbGlkYXRpb25GaWVsZChlcnJvciwgdGhpcy52YWxpZGF0ZSh0aGlzLm5hbWVGaWVsZC52YWx1ZS50cmltKCkpKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5hZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgIFN5c3RlbS5zaG93VmFsaWRhdGlvbkZpZWxkKGVycm9yLCB0aGlzLnZhbGlkYXRlKHRoaXMubmFtZUZpZWxkLnZhbHVlLnRyaW0oKSkpO1xyXG4gICAgICBpZiAoIXRoaXMudmFsaWRhdGUodGhpcy5uYW1lRmllbGQudmFsdWUudHJpbSgpKSkge1xyXG4gICAgICAgIHRoaXMuYWRkRnJhbWUodGhpcy53cmFwLCB0aGlzLm5hbWVGaWVsZC52YWx1ZS50cmltKCkpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgKG1lc3NhZ2UpID0+IHtcclxuICAgICAgaWYgKG1lc3NhZ2UuZGF0YSAmJiB0eXBlb2YgbWVzc2FnZS5kYXRhICE9PSAnb2JqZWN0Jykge1xyXG4gICAgICAgIHRoaXMucHVibGlzaCgncmVjZWl2ZWRNZXNzYWdlJywge1xyXG4gICAgICAgICAgbWVzc2FnZTogbWVzc2FnZS5kYXRhLFxyXG4gICAgICAgICAgdHlwZTogJ3VzZXInXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSBpZiAobWVzc2FnZS5kYXRhLmhhc093blByb3BlcnR5KCdyZW1vdmUnKSkge1xyXG4gICAgICAgIHRoaXMucmVtb3ZlRnJhbWUobWVzc2FnZS5kYXRhLnJlbW92ZSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iXX0=
