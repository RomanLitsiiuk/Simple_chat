"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var System=function(e){function i(e,t,r){var n;return _classCallCheck(this,i),(n=_possibleConstructorReturn(this,_getPrototypeOf(i).call(this))).addButton=e,n.wrap=t,n.nameField=r,n.iframes=[],n.invalidName=!1,n}return _inherits(i,Mediator),_createClass(i,[{key:"generateName",value:function(){var e=this.iframes.reduce(function(e,t){if(-1===t.name.indexOf("iFrame"))return e;var r=parseInt(+t.name.slice(t.name.indexOf("e")+1),10);return e<r?r:e},0);return"iFrame".concat(e+1)}},{key:"addFrame",value:function(e,t){var r=this;this.generateName();var n=new IFrame(t||this.generateName(),this).renderIframe();this.iframes.push(n),e.append(n),setTimeout(function(){r.publish("receivedMessage",{message:"[system]: ".concat(n.name," joined the conversation"),type:"system"})},300)}},{key:"removeFrame",value:function(t){var e=this.iframes.find(function(e){return e.name===t});this.iframes.splice(this.iframes.indexOf(e),1),this.wrap.removeChild(e),this.publish("receivedMessage",{message:"[system]: ".concat(t," left this conversation"),type:"system"})}},{key:"validate",value:function(t){return this.invalidName=this.iframes.some(function(e){return e.name===t}),this.invalidName}},{key:"render",value:function(){var t=this,e=document.querySelector(".error");this.nameField.addEventListener("input",function(){i.showValidationField(e,t.validate(t.nameField.value.trim()))}),this.addButton.addEventListener("click",function(){i.showValidationField(e,t.validate(t.nameField.value.trim())),t.validate(t.nameField.value.trim())||t.addFrame(t.wrap,t.nameField.value.trim())}),window.addEventListener("message",function(e){e.data&&"object"!==_typeof(e.data)?t.publish("receivedMessage",{message:e.data,type:"user"}):e.data.hasOwnProperty("remove")&&t.removeFrame(e.data.remove)})}}],[{key:"showValidationField",value:function(e,t){t?e.classList.add("error--active"):e.classList.remove("error--active")}}]),i}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3N5c3RlbS5qcyJdLCJuYW1lcyI6WyJTeXN0ZW0iLCJidXR0b24iLCJ3cmFwcGVyIiwibmFtZUZpZWxkIiwiX3RoaXMiLCJfY2xhc3NDYWxsQ2hlY2siLCJ0aGlzIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iLCJfZ2V0UHJvdG90eXBlT2YiLCJjYWxsIiwiYWRkQnV0dG9uIiwid3JhcCIsImlmcmFtZXMiLCJpbnZhbGlkTmFtZSIsIk1lZGlhdG9yIiwibGFzdE51bWJlciIsInJlZHVjZSIsInByZXYiLCJmcmFtZSIsIm5hbWUiLCJpbmRleE9mIiwibnVtYmVyIiwicGFyc2VJbnQiLCJzbGljZSIsImNvbmNhdCIsIl90aGlzMiIsImdlbmVyYXRlTmFtZSIsIklGcmFtZSIsInJlbmRlcklmcmFtZSIsInB1c2giLCJhcHBlbmQiLCJzZXRUaW1lb3V0IiwicHVibGlzaCIsIm1lc3NhZ2UiLCJ0eXBlIiwiZGVsZXRlZCIsImZpbmQiLCJzcGxpY2UiLCJyZW1vdmVDaGlsZCIsInNvbWUiLCJfdGhpczMiLCJlcnJvciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJzaG93VmFsaWRhdGlvbkZpZWxkIiwidmFsaWRhdGUiLCJ2YWx1ZSIsInRyaW0iLCJhZGRGcmFtZSIsIndpbmRvdyIsImRhdGEiLCJfdHlwZW9mIiwiaGFzT3duUHJvcGVydHkiLCJyZW1vdmVGcmFtZSIsInJlbW92ZSIsImVycm9yRmllbGQiLCJ2YWxpZFN0YXR1cyIsImNsYXNzTGlzdCIsImFkZCJdLCJtYXBwaW5ncyI6IkFBQUEsazZDQUVNQSxtQkFDSixTQUFBQSxFQUFZQyxFQUFRQyxFQUFTQyxHQUFXLElBQUFDLEVBQUEsT0FBQUMsZ0JBQUFDLEtBQUFOLElBQ3RDSSxFQUFBRywyQkFBQUQsS0FBQUUsZ0JBQUFSLEdBQUFTLEtBQUFILFFBQ0tJLFVBQVlULEVBQ2pCRyxFQUFLTyxLQUFPVCxFQUNaRSxFQUFLRCxVQUFZQSxFQUNqQkMsRUFBS1EsUUFBVSxHQUNmUixFQUFLUyxhQUFjLEVBTm1CVCxxQkFEckJVLCtEQVdqQixJQUFNQyxFQUFhVCxLQUFLTSxRQUFRSSxPQUFPLFNBQUNDLEVBQU1DLEdBQzVDLElBQXNDLElBQWxDQSxFQUFNQyxLQUFLQyxRQUFRLFVBQ3JCLE9BQU9ILEVBRVQsSUFBTUksRUFBU0MsVUFBVUosRUFBTUMsS0FBS0ksTUFBTUwsRUFBTUMsS0FBS0MsUUFBUSxLQUFPLEdBQUksSUFDeEUsT0FBZ0JILEVBQVRJLEVBQWdCQSxFQUFTSixHQUMvQixHQUNILE1BQUEsU0FBQU8sT0FBZ0JULEVBQWEsb0NBR3RCYixFQUFTaUIsR0FBTSxJQUFBTSxFQUFBbkIsS0FDdEJBLEtBQUtvQixlQUNMLElBQU1SLEVBQVEsSUFBSVMsT0FBT1IsR0FBUWIsS0FBS29CLGVBQWdCcEIsTUFBTXNCLGVBQzVEdEIsS0FBS00sUUFBUWlCLEtBQUtYLEdBQ2xCaEIsRUFBUTRCLE9BQU9aLEdBQ2ZhLFdBQVcsV0FDVE4sRUFBS08sUUFBUSxrQkFBbUIsQ0FDOUJDLFFBQU8sYUFBQVQsT0FBZU4sRUFBTUMsS0FBckIsNEJBQ1BlLEtBQU0sWUFFUCx5Q0FHT2YsR0FDVixJQUFNZ0IsRUFBVTdCLEtBQUtNLFFBQVF3QixLQUFLLFNBQUNsQixHQUNqQyxPQUFPQSxFQUFNQyxPQUFTQSxJQUV4QmIsS0FBS00sUUFBUXlCLE9BQU8vQixLQUFLTSxRQUFRUSxRQUFRZSxHQUFVLEdBQ25EN0IsS0FBS0ssS0FBSzJCLFlBQVlILEdBQ3RCN0IsS0FBSzBCLFFBQVEsa0JBQW1CLENBQzlCQyxRQUFPLGFBQUFULE9BQWVMLEVBQWYsMkJBQ1BlLEtBQU0sNENBUURmLEdBSVAsT0FIQWIsS0FBS08sWUFBY1AsS0FBS00sUUFBUTJCLEtBQUssU0FBQ3JCLEdBQ3BDLE9BQU9BLEVBQU1DLE9BQVNBLElBRWpCYixLQUFLTyw2Q0FHTCxJQUFBMkIsRUFBQWxDLEtBQ0RtQyxFQUFRQyxTQUFTQyxjQUFjLFVBQ3JDckMsS0FBS0gsVUFBVXlDLGlCQUFpQixRQUFTLFdBQ3ZDNUMsRUFBTzZDLG9CQUFvQkosRUFBT0QsRUFBS00sU0FBU04sRUFBS3JDLFVBQVU0QyxNQUFNQyxXQUV2RTFDLEtBQUtJLFVBQVVrQyxpQkFBaUIsUUFBUyxXQUN2QzVDLEVBQU82QyxvQkFBb0JKLEVBQU9ELEVBQUtNLFNBQVNOLEVBQUtyQyxVQUFVNEMsTUFBTUMsU0FDaEVSLEVBQUtNLFNBQVNOLEVBQUtyQyxVQUFVNEMsTUFBTUMsU0FDdENSLEVBQUtTLFNBQVNULEVBQUs3QixLQUFNNkIsRUFBS3JDLFVBQVU0QyxNQUFNQyxVQUdsREUsT0FBT04saUJBQWlCLFVBQVcsU0FBQ1gsR0FDOUJBLEVBQVFrQixNQUFnQyxXQUF4QkMsUUFBT25CLEVBQVFrQixNQUNqQ1gsRUFBS1IsUUFBUSxrQkFBbUIsQ0FDOUJDLFFBQVNBLEVBQVFrQixLQUNqQmpCLEtBQU0sU0FFQ0QsRUFBUWtCLEtBQUtFLGVBQWUsV0FDckNiLEVBQUtjLFlBQVlyQixFQUFRa0IsS0FBS0ksd0RBN0JUQyxFQUFZQyxHQUNyQ0EsRUFBY0QsRUFBV0UsVUFBVUMsSUFBSSxpQkFBbUJILEVBQVdFLFVBQVVILE9BQU8iLCJmaWxlIjoianMvc3lzdGVtLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcclxuXHJcbmNsYXNzIFN5c3RlbSBleHRlbmRzIE1lZGlhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihidXR0b24sIHdyYXBwZXIsIG5hbWVGaWVsZCkge1xyXG4gICAgc3VwZXIoKTtcclxuICAgIHRoaXMuYWRkQnV0dG9uID0gYnV0dG9uO1xyXG4gICAgdGhpcy53cmFwID0gd3JhcHBlcjtcclxuICAgIHRoaXMubmFtZUZpZWxkID0gbmFtZUZpZWxkO1xyXG4gICAgdGhpcy5pZnJhbWVzID0gW107XHJcbiAgICB0aGlzLmludmFsaWROYW1lID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBnZW5lcmF0ZU5hbWUoKSB7XHJcbiAgICBjb25zdCBsYXN0TnVtYmVyID0gdGhpcy5pZnJhbWVzLnJlZHVjZSgocHJldiwgZnJhbWUpID0+IHtcclxuICAgICAgaWYgKGZyYW1lLm5hbWUuaW5kZXhPZignaUZyYW1lJykgPT09IC0xKSB7XHJcbiAgICAgICAgcmV0dXJuIHByZXY7XHJcbiAgICAgIH1cclxuICAgICAgY29uc3QgbnVtYmVyID0gcGFyc2VJbnQoK2ZyYW1lLm5hbWUuc2xpY2UoZnJhbWUubmFtZS5pbmRleE9mKCdlJykgKyAxKSwgMTApO1xyXG4gICAgICByZXR1cm4gbnVtYmVyID4gcHJldiA/IG51bWJlciA6IHByZXY7XHJcbiAgICB9LCAwKTtcclxuICAgIHJldHVybiBgaUZyYW1lJHtsYXN0TnVtYmVyICsgMX1gO1xyXG4gIH1cclxuXHJcbiAgYWRkRnJhbWUod3JhcHBlciwgbmFtZSkge1xyXG4gICAgdGhpcy5nZW5lcmF0ZU5hbWUoKTtcclxuICAgIGNvbnN0IGZyYW1lID0gbmV3IElGcmFtZShuYW1lIHx8IHRoaXMuZ2VuZXJhdGVOYW1lKCksIHRoaXMpLnJlbmRlcklmcmFtZSgpO1xyXG4gICAgdGhpcy5pZnJhbWVzLnB1c2goZnJhbWUpO1xyXG4gICAgd3JhcHBlci5hcHBlbmQoZnJhbWUpO1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIHRoaXMucHVibGlzaCgncmVjZWl2ZWRNZXNzYWdlJywge1xyXG4gICAgICAgIG1lc3NhZ2U6IGBbc3lzdGVtXTogJHtmcmFtZS5uYW1lfSBqb2luZWQgdGhlIGNvbnZlcnNhdGlvbmAsXHJcbiAgICAgICAgdHlwZTogJ3N5c3RlbSdcclxuICAgICAgfSk7XHJcbiAgICB9LCAzMDApO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlRnJhbWUobmFtZSkge1xyXG4gICAgY29uc3QgZGVsZXRlZCA9IHRoaXMuaWZyYW1lcy5maW5kKChmcmFtZSkgPT4ge1xyXG4gICAgICByZXR1cm4gZnJhbWUubmFtZSA9PT0gbmFtZTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5pZnJhbWVzLnNwbGljZSh0aGlzLmlmcmFtZXMuaW5kZXhPZihkZWxldGVkKSwgMSk7XHJcbiAgICB0aGlzLndyYXAucmVtb3ZlQ2hpbGQoZGVsZXRlZCk7XHJcbiAgICB0aGlzLnB1Ymxpc2goJ3JlY2VpdmVkTWVzc2FnZScsIHtcclxuICAgICAgbWVzc2FnZTogYFtzeXN0ZW1dOiAke25hbWV9IGxlZnQgdGhpcyBjb252ZXJzYXRpb25gLFxyXG4gICAgICB0eXBlOiAnc3lzdGVtJ1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgc2hvd1ZhbGlkYXRpb25GaWVsZChlcnJvckZpZWxkLCB2YWxpZFN0YXR1cykge1xyXG4gICAgdmFsaWRTdGF0dXMgPyBlcnJvckZpZWxkLmNsYXNzTGlzdC5hZGQoJ2Vycm9yLS1hY3RpdmUnKSA6IGVycm9yRmllbGQuY2xhc3NMaXN0LnJlbW92ZSgnZXJyb3ItLWFjdGl2ZScpO1xyXG4gIH1cclxuXHJcbiAgdmFsaWRhdGUobmFtZSkge1xyXG4gICAgdGhpcy5pbnZhbGlkTmFtZSA9IHRoaXMuaWZyYW1lcy5zb21lKChmcmFtZSkgPT4ge1xyXG4gICAgICByZXR1cm4gZnJhbWUubmFtZSA9PT0gbmFtZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuaW52YWxpZE5hbWU7XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCBlcnJvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lcnJvcicpO1xyXG4gICAgdGhpcy5uYW1lRmllbGQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XHJcbiAgICAgIFN5c3RlbS5zaG93VmFsaWRhdGlvbkZpZWxkKGVycm9yLCB0aGlzLnZhbGlkYXRlKHRoaXMubmFtZUZpZWxkLnZhbHVlLnRyaW0oKSkpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLmFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgU3lzdGVtLnNob3dWYWxpZGF0aW9uRmllbGQoZXJyb3IsIHRoaXMudmFsaWRhdGUodGhpcy5uYW1lRmllbGQudmFsdWUudHJpbSgpKSk7XHJcbiAgICAgIGlmICghdGhpcy52YWxpZGF0ZSh0aGlzLm5hbWVGaWVsZC52YWx1ZS50cmltKCkpKSB7XHJcbiAgICAgICAgdGhpcy5hZGRGcmFtZSh0aGlzLndyYXAsIHRoaXMubmFtZUZpZWxkLnZhbHVlLnRyaW0oKSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCAobWVzc2FnZSkgPT4ge1xyXG4gICAgICBpZiAobWVzc2FnZS5kYXRhICYmIHR5cGVvZiBtZXNzYWdlLmRhdGEgIT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgdGhpcy5wdWJsaXNoKCdyZWNlaXZlZE1lc3NhZ2UnLCB7XHJcbiAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLmRhdGEsXHJcbiAgICAgICAgICB0eXBlOiAndXNlcidcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIGlmIChtZXNzYWdlLmRhdGEuaGFzT3duUHJvcGVydHkoJ3JlbW92ZScpKSB7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVGcmFtZShtZXNzYWdlLmRhdGEucmVtb3ZlKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiJdfQ==
