"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var IFrame=function(){function a(e,t){_classCallCheck(this,a),this.name=e,this.system=t,this.createTag=createTag,this.frame=this.createTag("iframe","iframe"),this.chat=null,this.isOwnMessage=!1}return _createClass(a,[{key:"clearChat",value:function(){for(;170<+this.chat.offsetHeight;)this.chat.removeChild(this.chat.children[0])}},{key:"listenMessages",value:function(){var a=this;this.system.subscribe("receivedMessage",function(e){var t=a.createTag("p","iframe__text");t.append(e.message),"system"===e.type?t.classList.add("iframe__text--system"):a.isOwnMessage&&(t.classList.add("iframe__text--own"),a.isOwnMessage=!1),a.chat.appendChild(t),a.clearChat()})}},{key:"activateDragable",value:function(e){var a=this;e.ondragstart=function(){return!1},e.onmousedown=function(t){t.target.classList.contains("iframe__input")||t.target.classList.contains("iframe__send")||t.target.classList.contains("iframe__close")||(a.frame.style.left=a.frame.offsetLeft+"px",a.frame.style.top=a.frame.offsetTop+"px",a.frame.classList.add("iframe--drag"),a.frame.style.zIndex=999,e.onmousemove=function(e){a.frame.style.left=parseInt(a.frame.style.left,10)+e.pageX-t.pageX+"px",a.frame.style.top=parseInt(a.frame.style.top,10)+e.pageY-t.pageY+"px"},e.onmouseup=function(){e.onmousemove=null,e.onmouseup=null,e.onmouseover=null,a.frame.style.zIndex=100},e.onmouseover=function(){e.onmousemove=null,e.onmouseup=null,e.onmouseup=null,a.frame.style.zIndex=100})}}},{key:"renderIframe",value:function(){var l=this;this.frame.setAttribute("name","".concat(this.name)),this.frame.setAttribute("scrolling","no");var f=this.createTag("link");return f.setAttribute("href","./css/app.min.css"),f.setAttribute("rel","stylesheet"),f.setAttribute("type","text/css"),this.frame.onload=function(){var e=l.frame.contentWindow.document;e.head.appendChild(f);var t=l.createTag("div","iframe__chat"),a=l.createTag("div","iframe__close"),n=l.createTag("h3","iframe__text","iframe__text--heading"),s=l.createTag("div","iframe__content");l.chat=s;var i=l.createTag("div","iframe__input-wrap"),r=l.createTag("label","iframe__label"),o=l.createTag("input","iframe__input");o.setAttribute("type","text");var c=l.createTag("button","iframe__send");c.setAttribute("type","button"),c.append("send"),n.append("Chat: "),e.body.appendChild(t).appendChild(n),t.appendChild(s),t.appendChild(a),e.body.appendChild(i).appendChild(r),r.append("[".concat(l.name,"]: ")),r.appendChild(o),i.appendChild(c),c.addEventListener("click",function(){l.frame.contentWindow.parent.postMessage("[".concat(l.name,"] - ").concat(o.value)),l.isOwnMessage=!0}),a.addEventListener("click",function(){l.frame.contentWindow.parent.postMessage({remove:l.name})}),l.activateDragable(e.body)},this.system&&this.listenMessages(),this.frame}}]),a}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL2lmcmFtZS5qcyJdLCJuYW1lcyI6WyJJRnJhbWUiLCJuYW1lIiwic3lzdGVtIiwiX2NsYXNzQ2FsbENoZWNrIiwidGhpcyIsImNyZWF0ZVRhZyIsImZyYW1lIiwiY2hhdCIsImlzT3duTWVzc2FnZSIsIm9mZnNldEhlaWdodCIsInJlbW92ZUNoaWxkIiwiY2hpbGRyZW4iLCJfdGhpcyIsInN1YnNjcmliZSIsImRhdGEiLCJtZXNzYWdlIiwiYXBwZW5kIiwidHlwZSIsImNsYXNzTGlzdCIsImFkZCIsImFwcGVuZENoaWxkIiwiY2xlYXJDaGF0IiwiZWxlbWVudCIsIl90aGlzMiIsIm9uZHJhZ3N0YXJ0Iiwib25tb3VzZWRvd24iLCJldmVudCIsInRhcmdldCIsImNvbnRhaW5zIiwic3R5bGUiLCJsZWZ0Iiwib2Zmc2V0TGVmdCIsInRvcCIsIm9mZnNldFRvcCIsInpJbmRleCIsIm9ubW91c2Vtb3ZlIiwiZSIsInBhcnNlSW50IiwicGFnZVgiLCJwYWdlWSIsIm9ubW91c2V1cCIsIm9ubW91c2VvdmVyIiwiX3RoaXMzIiwic2V0QXR0cmlidXRlIiwiY29uY2F0IiwiY3NzTGluayIsIm9ubG9hZCIsImlmcmFtZURvYyIsImNvbnRlbnRXaW5kb3ciLCJkb2N1bWVudCIsImhlYWQiLCJjbG9zZSIsImhlYWRpbmciLCJtZXNzYWdlcyIsImlucHV0V3JhcCIsImxhYmVsIiwiaW5wdXQiLCJzZW5kIiwiYm9keSIsImFkZEV2ZW50TGlzdGVuZXIiLCJwYXJlbnQiLCJwb3N0TWVzc2FnZSIsInZhbHVlIiwicmVtb3ZlIiwiYWN0aXZhdGVEcmFnYWJsZSIsImxpc3Rlbk1lc3NhZ2VzIl0sIm1hcHBpbmdzIjoidVpBQU1BLGtCQUNKLFNBQUFBLEVBQVlDLEVBQU1DLEdBQVFDLGdCQUFBQyxLQUFBSixHQUN4QkksS0FBS0gsS0FBT0EsRUFDWkcsS0FBS0YsT0FBU0EsRUFDZEUsS0FBS0MsVUFBWUEsVUFDakJELEtBQUtFLE1BQVFGLEtBQUtDLFVBQVUsU0FBVSxVQUN0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T0FBTyxVQUNmK0IsRUFBVVcsS0FBS3RDLFlBQVliLEdBQU1hLFlBQVlnQyxHQUM3QzdDLEVBQUthLFlBQVlpQyxHQUNqQjlDLEVBQUthLFlBQVkrQixHQUNqQkosRUFBVVcsS0FBS3RDLFlBQVlrQyxHQUFXbEMsWUFBWW1DLEdBQ2xEQSxFQUFNdkMsT0FBTixJQUFBNEIsT0FBaUJGLEVBQUt6QyxLQUF0QixRQUNBc0QsRUFBTW5DLFlBQVlvQyxHQUNsQkYsRUFBVWxDLFlBQVlxQyxHQUN0QkEsRUFBS0UsaUJBQWlCLFFBQVMsV0FDN0JqQixFQUFLcEMsTUFBTTBDLGNBQWNZLE9BQU9DLFlBQWhDLElBQUFqQixPQUFnREYsRUFBS3pDLEtBQXJELFFBQUEyQyxPQUFnRVksRUFBTU0sUUFDdEVwQixFQUFLbEMsY0FBZSxJQUV0QjJDLEVBQU1RLGlCQUFpQixRQUFTLFdBQzlCakIsRUFBS3BDLE1BQU0wQyxjQUFjWSxPQUFPQyxZQUFZLENBQUNFLE9BQVFyQixFQUFLekMsU0FFNUR5QyxFQUFLc0IsaUJBQWlCakIsRUFBVVcsT0FFOUJ0RCxLQUFLRixRQUNQRSxLQUFLNkQsaUJBRUE3RCxLQUFLRSIsImZpbGUiOiJqcy9pZnJhbWUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgSUZyYW1lIHtcclxuICBjb25zdHJ1Y3RvcihuYW1lLCBzeXN0ZW0pIHtcclxuICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICB0aGlzLnN5c3RlbSA9IHN5c3RlbTtcclxuICAgIHRoaXMuY3JlYXRlVGFnID0gY3JlYXRlVGFnO1xyXG4gICAgdGhpcy5mcmFtZSA9IHRoaXMuY3JlYXRlVGFnKCdpZnJhbWUnLCAnaWZyYW1lJyk7XHJcbiAgICB0aGlzLmNoYXQgPSBudWxsO1xyXG4gICAgdGhpcy5pc093bk1lc3NhZ2UgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIGNsZWFyQ2hhdCgpIHtcclxuICAgIHdoaWxlICgrdGhpcy5jaGF0Lm9mZnNldEhlaWdodCA+IDE3MCkge1xyXG4gICAgICB0aGlzLmNoYXQucmVtb3ZlQ2hpbGQodGhpcy5jaGF0LmNoaWxkcmVuWzBdKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGxpc3Rlbk1lc3NhZ2VzKCkge1xyXG4gICAgdGhpcy5zeXN0ZW0uc3Vic2NyaWJlKCdyZWNlaXZlZE1lc3NhZ2UnLCAoZGF0YSkgPT4ge1xyXG4gICAgICBjb25zdCBtZXNzYWdlID0gdGhpcy5jcmVhdGVUYWcoJ3AnLCAnaWZyYW1lX190ZXh0Jyk7XHJcbiAgICAgIG1lc3NhZ2UuYXBwZW5kKGRhdGEubWVzc2FnZSk7XHJcbiAgICAgIGlmIChkYXRhLnR5cGUgPT09ICdzeXN0ZW0nKSB7XHJcbiAgICAgICAgbWVzc2FnZS5jbGFzc0xpc3QuYWRkKCdpZnJhbWVfX3RleHQtLXN5c3RlbScpO1xyXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuaXNPd25NZXNzYWdlKSB7XHJcbiAgICAgICAgbWVzc2FnZS5jbGFzc0xpc3QuYWRkKCdpZnJhbWVfX3RleHQtLW93bicpO1xyXG4gICAgICAgIHRoaXMuaXNPd25NZXNzYWdlID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5jaGF0LmFwcGVuZENoaWxkKG1lc3NhZ2UpO1xyXG4gICAgICB0aGlzLmNsZWFyQ2hhdCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhY3RpdmF0ZURyYWdhYmxlKGVsZW1lbnQpIHtcclxuICAgIGVsZW1lbnQub25kcmFnc3RhcnQgPSAoKSA9PiB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICBlbGVtZW50Lm9ubW91c2Vkb3duID0gKGV2ZW50KSA9PiB7XHJcbiAgICAgIGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdpZnJhbWVfX2lucHV0JykgfHxcclxuICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdpZnJhbWVfX3NlbmQnKSB8fFxyXG4gICAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2lmcmFtZV9fY2xvc2UnKSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmZyYW1lLnN0eWxlLmxlZnQgPSB0aGlzLmZyYW1lLm9mZnNldExlZnQgKyAncHgnO1xyXG4gICAgICB0aGlzLmZyYW1lLnN0eWxlLnRvcCA9IHRoaXMuZnJhbWUub2Zmc2V0VG9wICsgJ3B4JztcclxuICAgICAgdGhpcy5mcmFtZS5jbGFzc0xpc3QuYWRkKCdpZnJhbWUtLWRyYWcnKTtcclxuICAgICAgdGhpcy5mcmFtZS5zdHlsZS56SW5kZXggPSA5OTk7XHJcbiAgICAgIGVsZW1lbnQub25tb3VzZW1vdmUgPSAoZSkgPT4ge1xyXG4gICAgICAgIHRoaXMuZnJhbWUuc3R5bGUubGVmdCA9IHBhcnNlSW50KHRoaXMuZnJhbWUuc3R5bGUubGVmdCwgMTApICsgZS5wYWdlWCAtIGV2ZW50LnBhZ2VYICsgJ3B4JztcclxuICAgICAgICB0aGlzLmZyYW1lLnN0eWxlLnRvcCA9IHBhcnNlSW50KHRoaXMuZnJhbWUuc3R5bGUudG9wLCAxMCkgKyBlLnBhZ2VZIC0gZXZlbnQucGFnZVkgKyAncHgnO1xyXG4gICAgICB9O1xyXG4gICAgICBlbGVtZW50Lm9ubW91c2V1cCA9ICgpID0+IHtcclxuICAgICAgICBlbGVtZW50Lm9ubW91c2Vtb3ZlID0gbnVsbDtcclxuICAgICAgICBlbGVtZW50Lm9ubW91c2V1cCA9IG51bGw7XHJcbiAgICAgICAgZWxlbWVudC5vbm1vdXNlb3ZlciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5mcmFtZS5zdHlsZS56SW5kZXggPSAxMDA7XHJcbiAgICAgIH07XHJcbiAgICAgIGVsZW1lbnQub25tb3VzZW92ZXIgPSAoKSA9PiB7XHJcbiAgICAgICAgZWxlbWVudC5vbm1vdXNlbW92ZSA9IG51bGw7XHJcbiAgICAgICAgZWxlbWVudC5vbm1vdXNldXAgPSBudWxsO1xyXG4gICAgICAgIGVsZW1lbnQub25tb3VzZXVwID0gbnVsbDtcclxuICAgICAgICB0aGlzLmZyYW1lLnN0eWxlLnpJbmRleCA9IDEwMDtcclxuICAgICAgfTtcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICByZW5kZXJJZnJhbWUoKSB7XHJcbiAgICB0aGlzLmZyYW1lLnNldEF0dHJpYnV0ZSgnbmFtZScsIGAke3RoaXMubmFtZX1gKTtcclxuICAgIHRoaXMuZnJhbWUuc2V0QXR0cmlidXRlKCdzY3JvbGxpbmcnLCAnbm8nKTtcclxuICAgIGNvbnN0IGNzc0xpbmsgPSB0aGlzLmNyZWF0ZVRhZygnbGluaycpO1xyXG4gICAgY3NzTGluay5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCAnLi9jc3MvYXBwLm1pbi5jc3MnKTtcclxuICAgIGNzc0xpbmsuc2V0QXR0cmlidXRlKCdyZWwnLCAnc3R5bGVzaGVldCcpO1xyXG4gICAgY3NzTGluay5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndGV4dC9jc3MnKTtcclxuICAgIHRoaXMuZnJhbWUub25sb2FkID0gKCkgPT4ge1xyXG4gICAgICBjb25zdCBpZnJhbWVEb2MgPSB0aGlzLmZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7XHJcbiAgICAgIGlmcmFtZURvYy5oZWFkLmFwcGVuZENoaWxkKGNzc0xpbmspO1xyXG4gICAgICBjb25zdCBjaGF0ID0gdGhpcy5jcmVhdGVUYWcoJ2RpdicsICdpZnJhbWVfX2NoYXQnKTtcclxuICAgICAgY29uc3QgY2xvc2UgPSB0aGlzLmNyZWF0ZVRhZygnZGl2JywgJ2lmcmFtZV9fY2xvc2UnKTtcclxuICAgICAgY29uc3QgaGVhZGluZyA9IHRoaXMuY3JlYXRlVGFnKCdoMycsICdpZnJhbWVfX3RleHQnLCAnaWZyYW1lX190ZXh0LS1oZWFkaW5nJyk7XHJcbiAgICAgIGNvbnN0IG1lc3NhZ2VzID0gdGhpcy5jcmVhdGVUYWcoJ2RpdicsICdpZnJhbWVfX2NvbnRlbnQnKTtcclxuICAgICAgdGhpcy5jaGF0ID0gbWVzc2FnZXM7XHJcbiAgICAgIGNvbnN0IGlucHV0V3JhcCA9IHRoaXMuY3JlYXRlVGFnKCdkaXYnLCAnaWZyYW1lX19pbnB1dC13cmFwJyk7XHJcbiAgICAgIGNvbnN0IGxhYmVsID0gdGhpcy5jcmVhdGVUYWcoJ2xhYmVsJywgJ2lmcmFtZV9fbGFiZWwnKTtcclxuICAgICAgY29uc3QgaW5wdXQgPSB0aGlzLmNyZWF0ZVRhZygnaW5wdXQnLCAnaWZyYW1lX19pbnB1dCcpO1xyXG4gICAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndGV4dCcpO1xyXG4gICAgICBjb25zdCBzZW5kID0gdGhpcy5jcmVhdGVUYWcoJ2J1dHRvbicsICdpZnJhbWVfX3NlbmQnKTtcclxuICAgICAgc2VuZC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnYnV0dG9uJyk7XHJcbiAgICAgIHNlbmQuYXBwZW5kKCdzZW5kJyk7XHJcbiAgICAgIGhlYWRpbmcuYXBwZW5kKCdDaGF0OiAnKTtcclxuICAgICAgaWZyYW1lRG9jLmJvZHkuYXBwZW5kQ2hpbGQoY2hhdCkuYXBwZW5kQ2hpbGQoaGVhZGluZyk7XHJcbiAgICAgIGNoYXQuYXBwZW5kQ2hpbGQobWVzc2FnZXMpO1xyXG4gICAgICBjaGF0LmFwcGVuZENoaWxkKGNsb3NlKTtcclxuICAgICAgaWZyYW1lRG9jLmJvZHkuYXBwZW5kQ2hpbGQoaW5wdXRXcmFwKS5hcHBlbmRDaGlsZChsYWJlbCk7XHJcbiAgICAgIGxhYmVsLmFwcGVuZChgWyR7dGhpcy5uYW1lfV06IGApO1xyXG4gICAgICBsYWJlbC5hcHBlbmRDaGlsZChpbnB1dCk7XHJcbiAgICAgIGlucHV0V3JhcC5hcHBlbmRDaGlsZChzZW5kKTtcclxuICAgICAgc2VuZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICB0aGlzLmZyYW1lLmNvbnRlbnRXaW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKGBbJHt0aGlzLm5hbWV9XSAtICR7aW5wdXQudmFsdWV9YCk7XHJcbiAgICAgICAgdGhpcy5pc093bk1lc3NhZ2UgPSB0cnVlO1xyXG4gICAgICB9KTtcclxuICAgICAgY2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5mcmFtZS5jb250ZW50V2luZG93LnBhcmVudC5wb3N0TWVzc2FnZSh7cmVtb3ZlOiB0aGlzLm5hbWV9KTtcclxuICAgICAgfSk7XHJcbiAgICAgIHRoaXMuYWN0aXZhdGVEcmFnYWJsZShpZnJhbWVEb2MuYm9keSk7XHJcbiAgICB9O1xyXG4gICAgaWYgKHRoaXMuc3lzdGVtKSB7XHJcbiAgICAgIHRoaXMubGlzdGVuTWVzc2FnZXMoKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLmZyYW1lO1xyXG4gIH1cclxufVxyXG4iXX0=
